This is an R package primarily designed for marginal hazard ratio estimation in clustered failure time data. The core of "marcox" is a semiparametric marginal proportional hazards model based on weighted estimating equations, which is suitable for handling strongly correlated clustered survival data. By introducing weighted estimating equations, "marcox" effectively captures and characterizes the correlation between individuals within clusters, thereby compensating for the efficiency loss caused by intra-cluster data correlation. This method not only enhances the estimation accuracy of the model but also ensures robustness when dealing with complex data. It adopts the concept of generalized estimating equations to address the influence of non-independence between individuals in clustered data, providing researchers with a new estimation tool for analyzing survival data with potential correlations in contexts such as multi-center trials, repeated measurements, and family data.

The package implements a weighted estimating equation approach based on a semiparametric marginal proportional hazards model, effectively handling intra-cluster correlation and enriching the existing survival analysis tools used by biostatisticians and epidemiologists. It is suitable for clustered data environments. "marcox" includes simulation functions and two example datasets, allowing users to demonstrate and test the model. The package depends on R version 4.4.0 or above and utilizes the "survival"， "Matrix"，“Rcpp” and "RcppEigen" packages for computation. It is not only applicable to the biomedical field but can also be extended to other areas such as social sciences and environmental analysis. "marcox" provides a new statistical analysis tool for handling clustered survival data, expanding the applicability of survival data analysis and offering a richer selection of statistical tools for researchers in biostatistics, epidemiology, sociology, and other fields.

The package has functions to calculate coefficients, robust standard error and p-value in Cox proportional hazard model. The data simulation model is also supported for users to create simulated clustered data up to arguments entered (lambda, b1, censrate, K, n, dimension) which satisfies Cox distribution.

This package is already available on CRAN: https://cran.r-project.org/web/packages/marcox/index.html. use "install.package('marcox')" and "library(marcox)" to install the package in R session.
